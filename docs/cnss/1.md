# ğŸŒ æ¢¦å¼€å§‹çš„åœ°æ–¹

## é¢˜ç›®

ç”¨ä½ æ‰¾åˆ°çš„ä¸‰é—¨è¯­è¨€ï¼ˆæ³¨æ„ï¼ŒæŸè¯­è¨€çš„æ–¹è¨€å’Œè¯¥è¯­è¨€ç®—ä½œåŒä¸€ç§è¯­è¨€ï¼‰å†™å‡ºä¸‹æ–‡ Scheme è¯­è¨€çš„ç­‰ä»·ä»£ç ï¼š

```Scheme
(define (make-withdraw balance)
  (lambda (amount)
    (if (>= balance amount)
        (begin (set! balance (- balance amount))
               balance)
        "væˆ‘50ï¼Œæ’«æ…°æˆ‘æ”¯é›¢ç ´ç¢çš„å¿ƒ")))

(define W1 (make-withdraw 100))
(define W2 (make-withdraw 100))

(W1 50)
; 50
(W2 70)
; 30
(W1 20)
; 30
```

é™„åŠ é¢˜ï¼š

- `20%`ï¼šåœ¨ç”¨æ³•ä¸å˜çš„å‰æä¸‹ï¼Œç”¨ä½ ç”¨è¿‡çš„å…¶ä¸­ä¸€ç§è¯­è¨€æˆ–è€… Lisp åŠå…¶æ–¹è¨€å¢åŠ ä»¥ä¸‹åŠŸèƒ½ï¼š

  ```Scheme
  (v50 W1)
  ```

  ä½¿å¾—ä½™é¢å¢åŠ  50 å…ƒã€‚

## è¯´æ˜

è¿™é“é¢˜ä¼šè®©äººä¸ç”±è‡ªä¸»çš„å†™ä¸€ä¸ªç±»å‡ºæ¥å½“ä¼ªå‡½æ•°ï¼Œç„¶è€Œå‡ºé¢˜äººçš„æœ¬æ„æ˜¯ä½¿ç”¨é—­åŒ…ï¼Œå› æ­¤é—®é¢˜å…³é”®ç‚¹åœ¨äºå¦‚ä½•æ•è·ã€‚


## é¢˜è§£

ä¸‹é¢ç»™å‡ºå››ç§è¯­è¨€çš„è§£

### C++

```C++
#include <iostream>
#include <functional>

std::function<void(int)> withdraw(int balance) {
    return [balance] (int amount) mutable {
        if (balance >= amount) {
            balance -= amount;
            if (amount >= 0)
                std::cout << balance << std::endl;
        } else {
            std::cout << "væˆ‘50ï¼Œæ’«æ…°æˆ‘æ”¯é›¢ç ´ç¢çš„å¿ƒ" << std::endl;
        }
    };
}

void v50(std::function<void(int)>& w) {
    w(-50);
}


int main() {
    auto w1 = withdraw(100), w2 = withdraw(100);
    w1(50);
    w2(70);
    w2(50);
    v50(w2);
    w2(50);
}
```

### Python

æˆ‘æäº¤çš„ç‰ˆæœ¬ï¼š

```python
def withdraw(balance):
    def apply(amount, balance = [balance]):
        if balance[0] >= amount:
            balance[0] -= amount
            if amount >= 0:
                print(balance[0])
        else:
            print('væˆ‘50ï¼Œæ’«æ…°æˆ‘æ”¯é›¢ç ´ç¢çš„å¿ƒ')
    return apply


def v50(w):
    w(-50)


w1 = withdraw(100)
w2 = withdraw(100)
w1(50)
w2(70)
w2(50)
v50(w2)
w2(50)
```

æ›´å¥½çš„ç‰ˆæœ¬ï¼š

```python
def withdraw(balance):
    def apply(amount):
        nonlocal balance
        if balance >= amount:
            balance -= amount
            if amount >= 0:
                print(balance)
        else:
            print('væˆ‘50ï¼Œæ’«æ…°æˆ‘æ”¯é›¢ç ´ç¢çš„å¿ƒ')
    return apply


def v50(w):
    w(-50)


w1 = withdraw(100)
w2 = withdraw(100)
w1(50)
w2(70)
w2(50)
v50(w2)
w2(50)
```

### JavaScript

```javascript
function withdraw(balance) {
    return function(amount) {
        if (balance >= amount) {
            balance -= amount
            if (amount >= 0) console.log(balance)
        } else {
            console.log('væˆ‘50ï¼Œæ’«æ…°æˆ‘æ”¯é›¢ç ´ç¢çš„å¿ƒ')
        }
    }
}

function v50(w) {
    w(-50)
}

var w1 = withdraw(100)
var w2 = withdraw(100)
w1(50)
w2(70)
w2(50)
v50(w2)
w2(50)
```

### Kotlin

```kotlin
fun withdraw(balance: Int): (Int)->Unit {
    var balance = balance
    return { amount: Int->
        if (balance >= amount) {
            balance -= amount
            if (amount >= 0)
                println(balance)
        } else {
            println("væˆ‘50ï¼Œæ’«æ…°æˆ‘æ”¯é›¢ç ´ç¢çš„å¿ƒ")
        }
    }
}

fun v50(w: (Int)->Unit) = w(-50)


fun main() {
    val w1 = withdraw(100)
    val w2 = withdraw(100)
    w1(50)
    w2(70)
    w2(50)
    v50(w2)
    w2(50)
}
```